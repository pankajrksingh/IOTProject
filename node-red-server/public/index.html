<!DOCTYPE html>
<html lang="en"><head>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Node-RED in Bluemix for IBM Internet of Things Foundation</title>

	<link href='http://fonts.googleapis.com/css?family=Roboto+Slab:400,700,300,100' rel='stylesheet' type='text/css'>
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">

	<link href="css/simplegrid.css" rel="stylesheet" media="screen">
	<link href="css/style.css" rel="stylesheet" media="screen">

	<script type="text/javascript">
		function checkIfSSL() {
			if (location.protocol === 'https:') {
				document.getElementById("noderedbutton").innerHTML = "Go to your Node-RED flow editor. <br>This application IS running over SSL. <br>Scroll down to password-protect the flow";
			} else {
				document.getElementById("noderedbutton").innerHTML = "Go to your Node-RED flow editor. <br>This application IS NOT running over SSL. <br>Scroll down to password-protect the flow";
			}
		}
		
		function rollbackToPrevious() {
			document.getElementById("noderedbutton").innerHTML = "Go to your Node-RED flow editor.";
		}
	</script>
	
</head>
<body>

<div class="header">
    <div class="header-content">
        <a href="/"><img class="logo" src="images/node-red.png" /> Node-RED in Bluemix for IBM Internet of Things Foundation</a>
    </div>
</div>
<!-- Grid 1 -->
<div class="title">
    <div class="grid">
        <div class="col-1-1">
            <div class="content">
                <h1>Node-RED in Bluemix</h1>
                <h2>A visual tool for wiring the Internet of Things</h2>
                <h2>IBM Internet of Things Foundation</h2>
                <img src="images/node-red-title-flow.png" />
            </div>
        </div>
    </div>
</div>

<!-- Grid 1/2 -->
<div class="row2">
    <div class="grid">
        <div class="col-1-2">
            <div class="content blurb">
            <p>Node-RED provides a browser-based editor that makes it easy to wire together flows that can be deployed to the runtime in a single click.</p>
            <p>The version running here has been customized for the IBM Internet of Things Foundation.</p>
            <p>We strongly suggest you secure your Node-RED flow editor with a username and password, as otherwise anyone who can guess the URL of this application will be able to launch the flow editor and access your IoT device data.</p>
            <p>To do this, follow the instructions that you find <a href="#passwordprotect">here</a>.</p>
            
<!-- 
            <p style="text-align: center"><a class="button" href="red/" id="noderedbutton" onmouseover="checkIfSSL();" onmouseout="rollbackToPrevious()">Go to your Node-RED flow editor</a></p>
 -->            
            <p style="text-align: center"><a class="button" href="red/">Go to your Node-RED flow editor</a></p>
    
            </div>
        </div>
        <div class="col-1-2">
            <div class="content feature"><img src="images/nr-image-1.png" /></div>
        </div>
    </div>
</div>
        
<!-- Grid 1/2 -->
<div class="row3">
    <div class="grid">
        <div class="col-1-1">
            <div class="content blurb">
                <h3>Using Node-RED with the IBM Internet of Things Foundation QuickStart</h3>
                <p>Use Node-RED to build an application using the data from any device that you have connected to the IBM Internet of Things Foundation.</p><br>
                <h4>Sample application</h4>
                <p>The sample has a ready-made flow that processes temperature readings from a simulated device. The flow checks these readings against a threshold, then tells you whether the temperature is safe. Imagine that we're monitoring a CPU temperature from a real device.</p>
                <p>To work through the sample application, follow the <a href="https://developer.ibm.com/iot/recipes/node-red-quickstart-application/" target="_blank">Node-RED IoT sample application recipe.</a></p>
                <br>
                <h4>Use your own device data</h4>
                <p>Use the MAC address of any device that you have already connected to the IBM Internet of Things Foundation.There are recipes available for <a href="http://www.ibm.com/developerworks/iot/recipes/raspberry-pi/" target="_blank">Raspberry Pi</a>, <a href="http://www.ibm.com/developerworks/iot/recipes/arm-mbed/" target="_blank">ARM mbed</a>, <a href="http://www.ibm.com/developerworks/iot/recipes/intel-galileo/" target="_blank">Intel Galileo</a> and <a href="http://www.ibm.com/developerworks/iot/recipes/ti-beaglebone-sensortag/" target="_blank">TI BeagleBone & SensorTag</a>.</p>
                <p>To view the complete list of IBM Internet of Things Foundation recipes go to the <a href="http://www.ibm.com/developerworks/iot/recipes" target="_blank">IBM IoT developerWorks site</a>.</p>
                <br>
                <h4>Check your device connection</h4>
                <p>If your device is connected you can visualize your data on the IBM Internet of Things Foundation QuickStart.</p>
                <form action="http://quickstart.internetofthings.ibmcloud.com/" method="get" target="_blank">            
                <div><span>Enter your MAC address here:</span></div>
                <div><span><input class="iot-recipe-field" type="text" name="deviceId" /><input class="iot-recipe-submit" type="submit" value="Visualize Your Data" /></span></div>
                </form>
                <br>
                <h4>Learn more about Node-RED</h4>
                <a href="http://nodered.org/docs/" target="_blank">Node-RED documentation</a>
            </div>
        </div>
    </div>
</div>
<div class="row4">
	<div class="grid">
		<div class="col-1-1">
			<div class="content blurb">
				<h3 id="custom">Customising your instance of Node-RED</h3>
				<p>This template instance of Node-RED is enough to get you started creating flows.</p>
				<p> </p>
				<p>You may want to customise it for your needs, for example replacing this introduction page with your own, adding http authentication to the flow editor or adding new nodes to the palette.</p>
				<p>To start customising your instance of Node-RED, you can use IBM Bluemix DevOps Services to edit and deploy your changes.</p>
				<div class="col-1-2">
				<div style="margin: 5px; border: 1px solid #ddd; border-radius: 5px; padding: 10px;">
					<h4>Using IBM DevOps Services</h4>
					<ol>
						<li>Within ACE, open the overview page for the application.</li>
						<li>Click the link to 'Add Git Integration' and follow the guide to import the application into IBM Bluemix DevOps Services.</li>
						<li>Once complete, click the 'Code' link to open it in IBM Bluemix DevOps Services.</li>
						<li>Customise the application following the guide below, commit your changes and push them back to Bluemix.</li>
					</ol>
				</div>
			</div>
			<p style="clear:both"></p>
			<h4><a id="passwordprotect">Password protect the flow editor</a></h4>
				<ol>
					<li>Choose the username and password that you want to use to protect the Node-RED flow editor. </li>
					<li>Node-RED uses bcrypt algorithm to securely hash the password. Use an bcrypt hash generator to compute the bcrypt hash of your password. </li>
					<li>In IBM Bluemix DevOps Services page, click "EDIT CODE" </li>
					<li>Navigate to the <code>bluemix-settings.js</code> and add the following:
					<pre>
adminAuth: {
    type: "credentials",
    users: [{
        username: "admin",
        password: "$2a$08$zZWtXTja0fB1pzD4sHCMyOCMYz2Z6dNbM6tl8sJogENOMcxWV9DN.",
        permissions: "*"
    }]
}
					</pre></li>
					<li>The <code>users</code> property is an array of user objects and allows you to define multiple users with different permissions.</li>
					<li>In this above sample, it defines a single user <code>admin</code> with password <code>password</code> and has permission to do everything within the editor. So replace <code>admin</code> with your username and <code>password</code> with your bcrypt hashed password.</li>
					<li>Finally commit the changes and push them back to Bluemix</li>
					<li>For more information on user authetication on Node-RED, check <a href="http://nodered.org/docs/security.html#enabling-user-authentication" target="_blank">Enabling user authentication</a>.</li>
				</ol>

			<h4>You can follow a similar process to make other customisations to Node-RED such as:</h4>

			<h4>Changing the static web content</h4>
			<ol>
				<li>The page you are reading now is served as static content from the application. This can be replaced with whatever content you want in the
					<code>public</code> directory.
				</li>
			</ol>
			<h4>Remove static web content and serve the flow editor from the root path</h4>
			<ol>
				<li>
				In the file
					<code>bluemix-settings.js</code>
					, delete the
					<code>httpStatic</code>
					and
					<code>httpAdminRoot</code>
					entries.
				</li>
				

				
			</ol>
			<h4>Adding new nodes to the palette</h4>
				<ol>
					<li>
					Drop the new node files into the
					<code>nodes</code>
					directory.
					</li>
					<li>
					Add any npm dependencies for the new nodes into the top-level
					<code>package.json</code>.
					</li>
				</ol>
			</div>
		</div>
	</div>
</div>

<div class="footer">
    <div class="grid">
        <div class="content">
            <div class="ets-link"><a href="http://ibm.com/blogs/et">Node-RED is a creation of IBM Emerging Technology</a></div>
            <div class="ets-link"><a href="http://ibm.com/blogs/et"><img class="ets-globe" src="images/ets-globe.png" /> </a></div>
        </div>
    </div>
</div>

</body>
</html>
